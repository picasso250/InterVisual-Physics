<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>简谐运动模拟</title>
    <!-- Note: common.css is not provided, assuming shm.css covers all necessary base styles. -->
    <link rel="stylesheet" href="shm.css">
</head>
<body>
    <canvas id="shmCanvas"></canvas>
    <div id="info">拖拽振子设置初始位置，点击画布开始模拟。</div>

    <div id="controls">
        <h3>简谐运动控制</h3>
        <div>
            <label for="massSlider">质量 (m):</label>
            <input type="range" id="massSlider" min="0.5" max="10" step="0.1">
            <span id="massValue"></span> kg
        </div>
        <div>
            <label for="springConstantSlider">弹簧常数 (k):</label>
            <input type="range" id="springConstantSlider" min="0.1" max="10" step="0.1">
            <span id="springConstantValue"></span> N/m
        </div>
        <button id="resetButton">重置</button>
    </div>

    <div id="dataDisplay">
        <table>
            <tr>
                <td>时间 (t):</td>
                <td><span id="timeValue">0.00</span> s</td>
            </tr>
            <tr>
                <td>位置 (X):</td>
                <td><span id="positionValue">0.00</span> m</td>
            </tr>
            <tr>
                <td>速度 (V):</td>
                <td><span id="velocityValue">0.00</span> m/s</td>
            </tr>
            <tr>
                <td>加速度 (A):</td>
                <td><span id="accelerationValue">0.00</span> m/s²</td>
            </tr>
            <tr>
                <td>动能 (KE):</td>
                <td><span id="kineticEnergyValue">0.00</span> J</td>
            </tr>
            <tr>
                <td>势能 (PE):</td>
                <td><span id="potentialEnergyValue">0.00</span> J</td>
            </tr>
            <tr>
                <td>总能量 (TE):</td>
                <td><span id="totalEnergyValue">0.00</span> J</td>
            </tr>
        </table>
    </div>

    <!-- 修改：运动学公式面板改为微分形式，并使用 MathML -->
    <div id="formulaExplanation">
        <h3>运动学公式 (微分形式推导)</h3>
        <p>简谐运动 (SHM) 微分形式推导：</p>

        <p><b>1. 恢复力 (胡克定律):</b></p>
        <p>恢复力 <span class="color-force">F</span> 与位移 <mi>x</mi> 成正比，方向相反：</p>
        <math display="block">
            <mrow>
                <mi>F</mi>
                <mo>=</mo>
                <mo>-</mo>
                <mi>k</mi>
                <mi>x</mi>
            </mrow>
        </math>
        <p><mi>k</mi> 为弹簧常数，<mi>x</mi> 为振子位移。</p>

        <p><b>2. 牛顿第二定律:</b></p>
        <p>合力 <span class="color-force">F</span> = <mi>m</mi><mi>a</mi>。</p>
        <p>加速度 <mi>a</mi> 是 <mi>x</mi> 对 <mi>t</mi> 的二阶导数：
        <math display="inline"><mrow><mi>a</mi><mo>=</mo><mfrac><mrow><msup><mi>d</mi><mn>2</mn></msup><mi>x</mi></mrow><mrow><mi>d</mi><msup><mi>t</mi><mn>2</mn></msup></mrow></mfrac></mrow></math>。</p>

        <p><b>3. 运动微分方程:</b></p>
        <math display="block">
            <mrow>
                <mi>m</mi><mi>a</mi>
                <mo>=</mo>
                <mo>-</mo>
                <mi>k</mi><mi>x</mi>
            </mrow>
        </math>
        <p>代入 <mi>a</mi>：</p>
        <math display="block">
            <mrow>
                <mi>m</mi>
                <mfrac>
                    <mrow>
                        <msup>
                            <mi>d</mi>
                            <mn>2</mn>
                        </msup>
                        <mi>x</mi>
                    </mrow>
                    <mrow>
                        <mi>d</mi>
                        <msup>
                            <mi>t</mi>
                            <mn>2</mn>
                        </msup>
                    </mrow>
                </mfrac>
                <mo>=</mo>
                <mo>-</mo>
                <mi>k</mi>
                <mi>x</mi>
            </mrow>
        </math>
        <p>整理成标准形式：</p>
        <math display="block">
            <mrow>
                <mfrac>
                    <mrow>
                        <msup>
                            <mi>d</mi>
                            <mn>2</mn>
                        </msup>
                        <mi>x</mi>
                    </mrow>
                    <mrow>
                        <mi>d</mi>
                        <msup>
                            <mi>t</mi>
                            <mn>2</mn>
                        </msup>
                    </mrow>
                </mfrac>
                <mo>+</mo>
                <mfrac>
                    <mi>k</mi>
                    <mi>m</mi>
                </mfrac>
                <mi>x</mi>
                <mo>=</mo>
                <mn>0</mn>
            </mrow>
        </math>
        <p>定义简谐运动。引入角频率 <mi>&omega;</mi>，其中 <math display="inline"><mrow><msup><mi>&omega;</mi><mn>2</mn></msup><mo>=</mo><mi>k</mi><mo>/</mo><mi>m</mi></mrow></math> (或 <math display="inline"><mrow><mi>&omega;</mi><mo>=</mo><msqrt><mrow><mi>k</mi><mo>/</mo><mi>m</mi></mrow></msqrt></mrow></math>)。</p>
        <p>最终形式：</p>
        <math display="block">
            <mrow>
                <mfrac>
                    <mrow>
                        <msup>
                            <mi>d</mi>
                            <mn>2</mn>
                        </msup>
                        <mi>x</mi>
                    </mrow>
                    <mrow>
                        <mi>d</mi>
                        <msup>
                            <mi>t</mi>
                            <mn>2</mn>
                        </msup>
                    </mrow>
                </mfrac>
                <mo>+</mo>
                <msup>
                    <mi>&omega;</mi>
                    <mn>2</mn>
                </msup>
                <mi>x</mi>
                <mo>=</mo>
                <mn>0</mn>
            </mrow>
        </math>
    </div>

    <script type="module" src="shm.js"></script>
</body>
</html>